import{r as d,o as h,b as D,d as a,g as A,e as s,w as n,f as r,l as I,t as u,m as M,E as O,u as T,i as p,h as m}from"./index-DBwGIS2Y.js";import{a as C}from"./api-CBBxTYRf.js";import{_ as J}from"./StatusTag-D7z7amcZ.js";const L={class:"page-header flex-between"},S={key:1,class:"card-section"},U={class:"flex-between",style:{"margin-bottom":"16px"}},j={style:{color:"#64748b"}},q={style:{"margin-top":"16px","text-align":"right"}},Q={__name:"ApprovalDetail",setup(z){const R=M(),B=T(),t=d(null),v=d(""),c=d(!1),i=d(!1);h(async()=>{const l=R.params.id;if(l){c.value=!0;try{t.value=await C.fetchApprovalDetail(l)}finally{c.value=!1}}});const _=async l=>{if(t.value){i.value=!0;try{await C.processApproval(t.value.id,{status:l,remark:v.value}),O.success(l==="APPROVED"?"已通过审批":"已驳回"),B.push("/manager/pending-approvals")}finally{i.value=!1}}};return(l,e)=>{var g,b,k,x,V,w;const f=r("el-breadcrumb-item"),N=r("el-breadcrumb"),P=r("el-skeleton"),$=r("el-input"),y=r("el-button");return p(),D("div",null,[a("div",L,[e[4]||(e[4]=a("h2",null,"审批处理",-1)),s(N,{separator:"/"},{default:n(()=>[s(f,{to:"/manager/pending-approvals"},{default:n(()=>[...e[3]||(e[3]=[m("待我审批",-1)])]),_:1}),s(f,null,{default:n(()=>{var o,E;return[m(u(((o=t.value)==null?void 0:o.displayId)??((E=t.value)==null?void 0:E.id)??"加载中"),1)]}),_:1})]),_:1})]),c.value?(p(),A(P,{key:0,rows:"4",style:{padding:"16px"}})):(p(),D("section",S,[a("div",U,[a("div",null,[a("h3",null,u(((g=t.value)==null?void 0:g.typeLabel)??((b=t.value)==null?void 0:b.type))+" - "+u(((k=t.value)==null?void 0:k.displayId)??((x=t.value)==null?void 0:x.id)),1),a("p",j,"发起人："+u((V=t.value)==null?void 0:V.applicant)+" | 提交时间："+u((w=t.value)==null?void 0:w.submittedAt),1)]),t.value?(p(),A(J,{key:0,status:t.value.status},null,8,["status"])):I("",!0)]),s($,{modelValue:v.value,"onUpdate:modelValue":e[0]||(e[0]=o=>v.value=o),type:"textarea",rows:5,placeholder:"填写审批意见"},null,8,["modelValue"]),a("div",q,[s(y,{onClick:e[1]||(e[1]=o=>_("REJECTED")),loading:i.value},{default:n(()=>[...e[5]||(e[5]=[m("驳回",-1)])]),_:1},8,["loading"]),s(y,{type:"primary",onClick:e[2]||(e[2]=o=>_("APPROVED")),loading:i.value},{default:n(()=>[...e[6]||(e[6]=[m(" 通过 ",-1)])]),_:1},8,["loading"])])]))])}}};export{Q as default};
